esphome:
  name: espnote
  friendly_name: "epaper"

esp32:
  board: esp32-s3-devkitc-1
  framework:
    type: esp-idf
  flash_size: 16MB

psram:
  mode: octal
  speed: 80MHz

# Enable logging
logger:

# Enable Home Assistant API
api:
  encryption:
    key: !secret espnote_apikey

ota:
  - platform: esphome
    password: !secret espnote_ota_password

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  manual_ip: 
    static_ip: 192.168.68.55
    gateway: 192.168.68.1
    subnet: 255.255.255.0

  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: "Espnote Fallback Hotspot"
    password: !secret espnote_ap_password

# Enable web server
web_server:
  port: 80
  # auth:
  #   username: !secret central_ws_user
  #   password: sp!secret central_ws_password

captive_portal:
  
#### Sensors ####

time:
  - platform: homeassistant
    id: homeassistant_time

# sensor:
#   - platform: homeassistant
#     name: "Current Temperature"
#     id: current_temperature
#     entity_id: weather.forecast_home
#     unit_of_measurement: "°F"
#     attribute: temperature
#     internal: True
#   - platform: homeassistant
#     name: "Forecast Temp Hi 1"
#     id: temphi1
#     entity_id: sensor.temperature_high_forecast_1
#     internal: True
#     unit_of_measurement: "°F"
#   - platform: homeassistant
#     name: "Forecast Temp Low 1"
#     id: templow1
#     entity_id: sensor.temperature_low_forecast_1
#     internal: True
#     unit_of_measurement: "°F"

# text_sensor:
#   - platform: homeassistant
#     id: current_condition
#     entity_id: weather.forecast_home
#     internal: True

#### Image and fonts ####

http_request:
  verify_ssl: false
  timeout: 10s
  watchdog_timeout: 15s

online_image:
  - id: dashboard_image
    format: PNG
    type: BINARY
    buffer_size: 30000
    url: http://192.168.68.56:10000/dashboard-small/0?viewport=296x128&eink=2&invert&format=PNG #change this link to your screenshot link
    update_interval: 60s
    on_download_finished:
      - delay: 100ms
      - component.update: main_display   

# font:
#   - file: "gfonts://Roboto"
#     id: my_font_12
#     size: 12
#     bpp: 4
#   - file: 
#       type: gfonts
#       family: Roboto
#       weight: 900
#     id: my_bold_12
#     size: 12
#     bpp: 4

spi:
  clk_pin: 12
  mosi_pin: 11

#### ePaper Display 2.9 inch) ####

display:
  - platform: waveshare_epaper
    id: main_display
    cs_pin: 10
    dc_pin: 4
    busy_pin: 6
    reset_pin: 5
    model: 2.90inv2
    rotation: 90
    reset_duration: 2ms
    update_interval: 60s
    full_update_every: 1
    lambda: |-
      it.image(0, 0, id(dashboard_image));

# display:
#   - platform: waveshare_epaper
#     id: main_display
#     cs_pin: 10
#     dc_pin: 4
#     busy_pin: 6
#     reset_pin: 5
#     model: 2.90inv2
#     rotation: 90
#     reset_duration: 2ms
#     update_interval: 60s
#     full_update_every: 1
#     lambda: |-
#       it.printf(05, 0,  id(my_font_12), "Temperature:        %.1f", id(current_temperature).state );
#       it.printf(05, 20, id(my_font_12), "Condition:             %s",   id(current_condition).state.c_str() );
#       it.printf(05, 40, id(my_font_12), "Day 1 Forecast Hi: %.1f", id(temphi1).state );
#       it.printf(05, 60, id(my_font_12), "Day 1 Forecast Lo: %.1f", id(templow1).state );
